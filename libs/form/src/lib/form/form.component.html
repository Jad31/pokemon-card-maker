<mat-progress-bar mode="determinate" [value]="step * 20"></mat-progress-bar>
<mat-accordion>
  <!-- Basic Information -->
  <mat-expansion-panel [expanded]="step === 0" (opened)="setStep(0)" hideToggle>
    <mat-expansion-panel-header>
      <mat-panel-title> Basic Information </mat-panel-title>
    </mat-expansion-panel-header>

    <mat-form-field appearance="fill">
      <mat-label>Name</mat-label>
      <input
        matInput
        #name
        [value]="formService.formState.name()"
        (input)="formFieldChange($event, 'name')"
      />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Type</mat-label>
      <mat-select
        #iconTypeOptions
        (selectionChange)="changeCardType(iconTypeOptions.value)"
      >
        <mat-option *ngFor="let type of formService.typeOptions" [value]="type">
          {{ type | titlecase }}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field appearance="fill">
      <mat-label>Stage</mat-label>
      <input
        matInput
        #stage
        [value]="formService.formState.stage()"
        (input)="formService.formState.stage.set(stage.value)"
      />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Health</mat-label>
      <input
        matInput
        #health
        [value]="formService.formState.health()"
        (input)="formService.formState.health.set(+health.value)"
        type="number"
        min="0"
      />
    </mat-form-field>

    <!-- <mat-form-field appearance="fill">
      <mat-label>Image</mat-label>
      <input
        matInput
        #characterImage
        type="file"
        (change)="fileChangeEvent($event)"
        [value]="formService.formState.characterImage()"
        (input)="formService.formState.characterImage.set(characterImage.value)"
      />
    </mat-form-field> -->
    <mat-action-row>
      <button mat-button color="primary" (click)="nextStep()">Next</button>
    </mat-action-row>
  </mat-expansion-panel>

  <!-- Picture -->

  <mat-expansion-panel [expanded]="step === 1" (opened)="setStep(1)" hideToggle>
    <mat-expansion-panel-header>
      <mat-panel-title> Picture </mat-panel-title>
    </mat-expansion-panel-header>
    <input #characterImage type="file" (change)="fileChangeEvent($event)" />

    <image-cropper
      [imageChangedEvent]="imageChangedEvent"
      [maintainAspectRatio]="true"
      [aspectRatio]="37 / 26"
      format="png"
      (imageCropped)="imageCropped($event)"
      (imageLoaded)="imageLoaded($event)"
      (cropperReady)="cropperReady()"
      (loadImageFailed)="loadImageFailed()"
    ></image-cropper>

    <mat-action-row>
      <button mat-button color="primary" (click)="nextStep()">Next</button>
    </mat-action-row>
  </mat-expansion-panel>

  <!-- Feature One -->
  <mat-expansion-panel [expanded]="step === 2" (opened)="setStep(2)" hideToggle>
    <mat-expansion-panel-header>
      <mat-panel-title> Ability One </mat-panel-title>
    </mat-expansion-panel-header>

    <mat-form-field appearance="fill">
      <mat-label>Ability Name</mat-label>
      <input
        matInput
        #abilityOneName
        [value]="formService.formState.abilityOneName()"
        (input)="formService.formState.abilityOneName.set(abilityOneName.value)"
      />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Description</mat-label>
      <textarea
        matInput
        #abilityOneDescription
        [value]="formService.formState.abilityOneDescription()"
        (input)="
          formService.formState.abilityOneDescription.set(
            abilityOneDescription.value
          )
        "
      >
      </textarea>
    </mat-form-field>

    <p>Energy Cost</p>
    <div class="energy-cost">
      <div class="cost-types">
        <div
          *ngFor="let cost of formService.abilityTypeCostOptions; index as i"
        >
          <img
            src="assets/{{
              formService.abilityTypeCostOptions[i] | lowercase
            }}-icon.png"
            (click)="addAbilityOneCost(cost)"
          />
        </div>
      </div>
      <hr style="width: 80%" />
      <div class="costs">
        <p>Cost:</p>
        <div
          *ngFor="
            let cost of formService.formState.abilityOneCost();
            index as i
          "
        >
          <img
            src="assets/{{
              formService.formState.abilityOneCost()[i] | lowercase
            }}-icon.png"
            (click)="removeAbilityOneCost(i)"
          />
        </div>
      </div>
    </div>

    <mat-form-field appearance="fill">
      <mat-label>Damage</mat-label>
      <input
        matInput
        #abilityOneDamage
        [value]="formService.formState.abilityOneDamage()"
        (input)="
          formService.formState.abilityOneDamage.set(+abilityOneDamage.value)
        "
        type="number"
        min="0"
      />
    </mat-form-field>
    <mat-action-row>
      <button mat-button color="primary" (click)="nextStep()">Next</button>
    </mat-action-row>
  </mat-expansion-panel>

  <!-- Feature Two -->
  <mat-expansion-panel [expanded]="step === 3" (opened)="setStep(3)" hideToggle>
    <mat-expansion-panel-header>
      <mat-panel-title> Ability Two </mat-panel-title>
    </mat-expansion-panel-header>

    <mat-form-field appearance="fill">
      <mat-label>Ability Name</mat-label>
      <input
        matInput
        #abilityTwoName
        [value]="formService.formState.abilityTwoName()"
        (input)="formService.formState.abilityTwoName.set(abilityTwoName.value)"
      />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Description</mat-label>
      <textarea
        matInput
        #abilityTwoDescription
        [value]="formService.formState.abilityTwoDescription()"
        (input)="
          formService.formState.abilityTwoDescription.set(
            abilityTwoDescription.value
          )
        "
      >
      </textarea>
    </mat-form-field>
    <p>Energy Cost</p>
    <div class="energy-cost">
      <div class="cost-types">
        <div
          *ngFor="let cost of formService.abilityTypeCostOptions; index as i"
        >
          <img
            src="assets/{{
              formService.abilityTypeCostOptions[i] | lowercase
            }}-icon.png"
            (click)="addAbilityTwoCost(cost)"
          />
        </div>
      </div>
      <hr style="width: 80%" />
      <div class="costs">
        <p>Cost:</p>
        <div
          *ngFor="
            let cost of formService.formState.abilityTwoCost();
            index as i
          "
        >
          <img
            src="assets/{{
              formService.formState.abilityTwoCost()[i] | lowercase
            }}-icon.png"
            (click)="removeAbilityTwoCost(i)"
          />
        </div>
      </div>
    </div>

    <mat-form-field appearance="fill">
      <mat-label>Damage</mat-label>
      <input
        matInput
        #abilityTwoDamage
        [value]="formService.formState.abilityTwoDamage()"
        (input)="
          formService.formState.abilityTwoDamage.set(+abilityTwoDamage.value)
        "
        type="number"
        min="0"
      />
    </mat-form-field>
    <mat-action-row>
      <button mat-button color="primary" (click)="nextStep()">Next</button>
    </mat-action-row>
  </mat-expansion-panel>

  <!-- Location, Work Environment, Availability -->
  <mat-expansion-panel [expanded]="step === 4" (opened)="setStep(4)" hideToggle>
    <mat-expansion-panel-header>
      <mat-panel-title>
        Location, Work Environment, and Availability
      </mat-panel-title>
    </mat-expansion-panel-header>

    <mat-form-field appearance="fill">
      <mat-label>Location</mat-label>
      <input
        matInput
        #location
        [value]="formService.formState.location()"
        (input)="formService.formState.location.set(location.value)"
      />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Work Environment</mat-label>
      <input
        matInput
        #workEnvironment
        environment
        [value]="formService.formState.workEnvironment()"
        (input)="
          formService.formState.workEnvironment.set(workEnvironment.value)
        "
      />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Availability</mat-label>
      <input
        matInput
        #availability
        [value]="formService.formState.availability()"
        (input)="formService.formState.availability.set(availability.value)"
      />
    </mat-form-field>
    <mat-action-row>
      <button mat-button color="primary" (click)="nextStep()">Next</button>
    </mat-action-row>
  </mat-expansion-panel>

  <!-- Additionals -->
  <mat-expansion-panel [expanded]="step === 5" (opened)="setStep(5)" hideToggle>
    <mat-expansion-panel-header>
      <mat-panel-title> Additional Information </mat-panel-title>
    </mat-expansion-panel-header>

    <mat-form-field appearance="fill">
      <mat-label>Upper Text</mat-label>
      <textarea
        matInput
        #upperText
        [value]="formService.formState.upperText()"
        (input)="formService.formState.upperText.set(upperText.value)"
      ></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Lower Text</mat-label>
      <textarea
        matInput
        #lowerText
        [value]="formService.formState.lowerText()"
        (input)="formService.formState.lowerText.set(lowerText.value)"
      >
      </textarea>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Illustrator</mat-label>
      <input
        matInput
        #illustrator
        [value]="formService.formState.illustrator()"
        (input)="formService.formState.illustrator.set(illustrator.value)"
      />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Company</mat-label>
      <input
        matInput
        #company
        [value]="formService.formState.company()"
        (input)="formService.formState.company.set(company.value)"
      />
    </mat-form-field>
    <mat-form-field appearance="fill">
      <mat-label>Card Number</mat-label>
      <input
        matInput
        #cardNumber
        [value]="formService.formState.cardNumber()"
        (input)="formService.formState.cardNumber.set(+cardNumber.value)"
        type="number"
        min="0"
      />
    </mat-form-field>
    <mat-action-row>
      <button mat-button color="primary" (click)="nextStep()">Next</button>
    </mat-action-row>
  </mat-expansion-panel>
</mat-accordion>
